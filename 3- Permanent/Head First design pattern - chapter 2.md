[[Eraasoft]]
#project/hfdp 

- الباترن الي عندنا بيتكلم عن ازاي نعرف لما حاجة تحصل ؟
- يعني بكل بساطة تخيل معايا ان في رسالة مهمة انت مستنيها عالتليفون ازاي تعرف انها جت
- هل بتفتح التليفون كل شوية تشوف الرسايل ولا انت عارف انها لما تيجي التليفون هيبعتلك اشعار او نوتفيكيشن

- هنا الكتاب بيديك مثال مشابه 
- بيقولك انت جالك عقد عشان تعمل برنامج بيستلم بيانات الطقس زي الحرارة و الرطوبة و الضغط الجوي و بيعرض البيانات دي على مجموعة من الشاشات
- حاجة مهمة هو ان الشاشة تعرض البيانات لما تيجي على طول 
- حاجة كمان هو اننا عاوزين نخلي الناس تقدر تزود شاشات بتعرض معلومات جديدة بسهولة
- انت حاليا معاك ال object بتاع ال weather و ده الي عليه البيانات و عليه method بتشتغل كل مرة البيانات بتتغير او كل ما تيجي بيانات جديدة
- دي شكلها نقطة مهمة جدا و هي الي هتساعدني اربط الشاشات بالبيانات ب ان كل مرة البيانات تتغير اقولها غيريلي الشاشات كمان
- ف انت اول فكرة ممكن تجيلك انك تكتب الكود بتاعك جوه هنا 
- هو تمام بس هتعمل ايه لما نضيف شاشات جديدة ؟ هتكتب الكود فين؟
- لو جينا كتبنا ده هيبقى شكله كده 
- الحل ده في مشاكل كتير في تصميمه زي مثلا
- بيشتغل على implemention الشاشات مش interface ليها مع ان الشاشات كلها ليها نفس الشكل.
- كل ما نضيف شاشة هنحتاج نغير الكود ف ده كده مش closed for modification 
- منقدرش نزود شاشات at run time يعني لازم نبقى عارفين الشاشات الي هنحتاجها قبل ما البرنامج يشتغل
- الشاشات ملهاش interface مشترك 
- الكود الي بيتغير محطوط وسط الكود الثابت

- ده يودينا لفكرة ال observer 
- الموضوع عامل زي ما تكون مشترك ف الجرنال او ف newsletter او حتى يا سيدي قناة يوتيوب او بتتابع اكونت حد معين عالسوشيال ميديا
- الاكونت بينشر محتوى او القناة بتنشر فيديوهات او غيره 
- و انت طول ما انت مشترك بيجيلك اشعارات كل ما حاجة تتنشر
- طيب افرض انت خللص مش مهتم بالقناة دي او بالحساب ده تقدر تلغي الاشتراك بكل بساطة
- الحساب مش هيقف و القناة مش هتبطل تنزل فيديوهات بس بكل يساطة الاشعارات مش هتجيلك

-  الباترن ده بيتضمن نوعين من ال objects 
- ال subject و ده صاحب المعلومة الي بينشرها زي قناة اليوتيوب او الجرنان
- و ال observers و دول المهتمين بالمعلومة الي ال subject بيبعتلهم

- نقدر نشرح حركة البيانات بيساطة ف مجموعة خطوات 
1. عندي subject معاه بيانات تهمني
2. بروح اقوله عاوز اشترك معاك و ده الي بنسميه ال subscribe 
3. ال subject بتجيله داتا جديدة 
4. بيبعت الداتا دي ليا انا و كل من هو مشترك معاه
5. جيه احد المشتركين قرر انه مش مهتم بالبيانات دي خلاص
6. بيروح لل subject يقوله الغي اشتراكي
7. ف ال subject بيشيله من قايمة الحجات الي هو بيبعتلها
8. ف لما تيجي بيانات جديدة هتيجيلي انا و كل المشتركين و مش هتيجي لغير المشتركين

- الكتاب بيشبه الموضوع ب مكاتب العمل او ال headhunters الي انت بتروح تسجل معاهم و لما يجيلهم وظيفة تناسبك بيبعتولك

- تعريف الباترن الرسمي بيقولك انه بينشئ علاقة one to many عشان لما ال one صاحب البيانات بياناته تتغير الباقي يجيلهم التغيير ده و يحسو بيه
- ف تاخد بالك ان ده معناه ان ال subject الواحد عنده many observers مش محكوم بعدد
- و كذلك العدد ده ممكن يتغير خلال ال runtime 
- و ده شكل ال classes 
- طبعا عندنا interfaces عشان نوحد شكل الكود
- عشان مهما كان شكل ال class الي عايز يشترك على الداتا هو محتاج الحجات دي بس
- ممكن تكون بتشبه على الكلام ده و بتقول انه شبه حاجة كده اسمها ال pub sub او ال publish subscribe pattern لكن ده اعمق منه و بيسمح بحجات اكتر

- الباترن ده بيعزز فكرة ال loose coupling الي من بتسمح لل classes انهم يتعاملو سوا من غير ما يكون بنهم ارتباط وثيق او يعرفو كتير عن بعض
- يعني مثلا ال subject ميعرفش عن ال observer اكتر من انه بي implement ال observer interface لا اكثر و حتى ميعرفش بيستخدم البيانات ازاي
- و ده بيسمح للي شئ انه يكون observer و كمان بيسمح اني اضيف و احذف observers خلال ال runtime لانهم ببساطة عبارة عن list of observers و ده معناه اني مبحتشج اعدل ف ال subject عشان اضيف او احذف
- كمان التغيير ف ال subject مبيأثرش على ال observer و العكس صحيح
- و كمان هما classes منفصلة ف اقدر استخدمهم باي شكل انا عاوزه

-  و ده يودينا ل design principle جديد عبارة عن انك تحاول على قدر الاستطاعة تصمم كود يكون loosely coupled.
- و ده لان كل ما كان الكود loosely coupled كل ما قدر يتعامل مع التغيير بسهولة لان العلاقات ما بين ال classe اقل ما يمكن.

-  عودة لارض الواقع كان معانا برنامج طقس و كود عاوزين نكتبه
- لو رجعنا للرسمه الي كنا راسمينها قبل كده هتبدأ تلاحظ ال observer pattern
- ال weatherData object هو الي شايل البيانات ف هو بيمثل ال subject و الشاشات محتاجه البيانات و محتاجه تعرف لو اتغيرت ف هي بتمثل ال observers
- هنبدأ نحط interfaces كاساسات للكود بتاعنا و نخلي ال weatherData object ي implement ال subject interface و الشاشات ت implement ال observer interface 

- عشان اعمل register لل observer بديله ال subject ف ال constructor 
- و ده بيفيدني اني لو حبيت بعدين الغي الغي اشتراكي اقدر اعمل كده بسهولة

- نقطة بسيطة ممكن نفكر فيها اكتر هي الجزء ده 
- انا هنا بدي البيانات لل update function واحدة ورا التانية
- طب افرض البيانات اتغير قدام يعني بدل ما كان معانا ال temperature و ال humidity و ال pressure زاد عليهم مثلا ال wind speed او الحرارة بقت عظمى و صغرى مثلا
- هل مع كل تغيير انا مضطر اغير الكود بتاعي ؟ هل في طريقة احسن ؟
- الطريقة للي احنا شغالين بيها هنا بنسميها ال push method معناها ان ال subject هو الي بيتحكم ف البيانات يديك ايه و ميديكش ايه
- لكن ده زي ما قلنا هيحتاج مني ان كل ما البيانات تتغير هحتاج اغير الكود
- ف ممكن نحوله ل pull method و هنا ال subject بيبعت البيانات كلها و ال observer بيسحب منها الي هو عاوزه


- لو عاوزين نشوف استخدام ال observer pattern ف حياتنا هتلاقيه ف اماكن كتير خصوصا الحاجات المرتبطة ب ال ui زي ال مثلا java swing او JavaScript events 
- بتلاقيهم بشكل add / remove listener عشان تنفذ حاجة لما يحصل event معين
- و كمان بتلاقيهم implemented as lambdas
- حاجة مهمة تاخد بالك منها لو انت بتستخدم جافا هو انها كان فيها observer و observable ك classes ف اللغة بس اتعملهم depreciation او اتلغو بداية من جافا ٩

